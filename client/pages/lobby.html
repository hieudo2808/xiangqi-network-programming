<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lobby - C·ªù T∆∞·ªõng Online</title>
    <!-- Lobby page has inline styles only -->
    <link rel="stylesheet" href="../assets/css/lobby.css">
</head>

<body>
    <div class="lobby-page">
        <header class="lobby-header">
            <h1>C·ªù T∆∞·ªõng Online</h1>
            <div class="user-info">
                <div class="user-profile">
                    <div class="user-avatar" id="user-avatar">U</div>
                    <div class="user-details">
                        <div class="user-name" id="user-name">Username</div>
                        <div class="user-rating" id="user-rating">Rating: 1500</div>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn-logout" id="btn-logout">ƒêƒÉng xu·∫•t</button>
                </div>
            </div>
        </header>

        <div class="lobby-content">
            <aside class="lobby-sidebar">
                <div class="menu-section">
                    <h3>Ch∆°i Game</h3>
                    <button class="menu-btn" data-action="create-room">T·∫°o Ph√≤ng</button>
                    <button class="menu-btn" data-action="room-list">Danh S√°ch Ph√≤ng</button>
                </div>

                <div class="menu-section">
                    <h3>Th·ªëng K√™</h3>
                    <button class="menu-btn" data-action="history">L·ªãch S·ª≠ Tr·∫≠n ƒê·∫•u</button>
                    <button class="menu-btn" data-action="spectate">Xem Tr·∫≠n ƒê·∫•u</button>
                    <button class="menu-btn" data-action="profile">H·ªì S∆°</button>
                </div>
            </aside>

            <main class="lobby-main">
                <div class="section-header">
                    <h2>T√¨m ƒê·ªëi Th·ªß</h2>
                    <button class="btn-primary" id="btn-find-match">T√¨m Tr·∫≠n</button>
                </div>

                <div id="searching-indicator" class="searching-indicator">
                    <div class="spinner"></div>
                    <h3>ƒêang t√¨m ƒë·ªëi th·ªß...</h3>
                    <p>Vui l√≤ng ch·ªù trong gi√¢y l√°t</p>
                    <button class="btn-danger" id="btn-cancel-search">H·ªßy</button>
                </div>

                <div id="match-found" class="match-found">
                    <h2>T√¨m th·∫•y ƒë·ªëi th·ªß!</h2>
                    <p id="opponent-info">ƒê·ªëi th·ªß: <strong>Player123</strong> (Rating: 1520)</p>
                    <button class="btn-primary" id="btn-start-game">B·∫Øt ƒê·∫ßu</button>
                </div>

                <div id="status-message" class="status-message" style="display: none;"></div>

                <div class="leaderboard-preview">
                    <div class="section-header">
                        <h2>Top Players</h2>
                    </div>
                    <table class="leaderboard-table">
                        <thead>
                            <tr>
                                <th>H·∫°ng</th>
                                <th>T√™n</th>
                                <th>Rating</th>
                                <th>Tr·∫≠n</th>
                                <th>T·ª∑ L·ªá</th>
                            </tr>
                        </thead>
                        <tbody id="leaderboard-body">
                            <tr>
                                <td><span class="rank-badge gold">1</span></td>
                                <td>Loading...</td>
                                <td>-</td>
                                <td>-</td>
                                <td>-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </main>
        </div>
    </div>

    <!-- Create Room Modal -->
    <div class="modal-overlay" id="create-room-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>T·∫°o Ph√≤ng Ch∆°i</h2>
                <button class="modal-close" onclick="closeModal('create-room-modal')">&times;</button>
            </div>
            <form id="create-room-form">
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u ph√≤ng (t√πy ch·ªçn)</label>
                    <input type="password" id="room-password" placeholder="ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng c·∫ßn m·∫≠t kh·∫©u">
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('create-room-modal')">H·ªßy</button>
                    <button type="submit" class="btn-primary">T·∫°o Ph√≤ng</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Room List Modal -->
    <div class="modal-overlay" id="room-list-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>Danh S√°ch Ph√≤ng</h2>
                <button class="modal-close" onclick="closeModal('room-list-modal')">&times;</button>
            </div>
            <div class="room-search">
                <input type="text" id="room-search-input" placeholder="Nh·∫≠p m√£ ph√≤ng ƒë·ªÉ t√¨m ki·∫øm..." 
                       oninput="filterRoomList()" autocomplete="off">
            </div>
            <div class="room-list" id="room-list-container">
                <div class="no-rooms">
                    <p>ƒêang t·∫£i...</p>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="refreshRoomList()">L√†m m·ªõi</button>
                <button type="button" class="btn-secondary" onclick="closeModal('room-list-modal')">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Join Room Password Modal -->
    <div class="modal-overlay" id="join-password-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>üîê Nh·∫≠p M·∫≠t Kh·∫©u</h2>
                <button class="modal-close" onclick="closeModal('join-password-modal')">&times;</button>
            </div>
            <form id="join-password-form">
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u ph√≤ng</label>
                    <input type="password" id="join-room-password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u ph√≤ng" required>
                </div>
                <input type="hidden" id="join-room-code">
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeModal('join-password-modal')">H·ªßy</button>
                    <button type="submit" class="btn-primary">V√†o Ph√≤ng</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Live Matches Modal (Spectate) -->
    <div class="modal-overlay" id="live-matches-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>Tr·∫≠n ƒê·∫•u ƒêang Di·ªÖn Ra</h2>
                <button class="modal-close" onclick="closeModal('live-matches-modal')">&times;</button>
            </div>
            <div class="live-matches-list" id="live-matches-container">
                <div class="no-matches">
                    <p>ƒêang t·∫£i...</p>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="refreshLiveMatches()">L√†m m·ªõi</button>
                <button type="button" class="btn-secondary" onclick="closeModal('live-matches-modal')">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal-overlay" id="profile-modal">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h2>H·ªì S∆° C√° Nh√¢n</h2>
                <button class="modal-close" onclick="closeModal('profile-modal')">&times;</button>
            </div>
            <div class="profile-content" id="profile-content">
                <div class="profile-loading">
                    <p>ƒêang t·∫£i...</p>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="copyUserId()">Copy ID</button>
                <button type="button" class="btn-secondary" onclick="closeModal('profile-modal')">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Waiting Room Modal -->
    <div class="modal-overlay" id="waiting-room-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>Ph√≤ng Ch∆°i</h2>
                <button class="modal-close" onclick="leaveRoom()">&times;</button>
            </div>
            <div class="waiting-room">
                <div class="room-code-display">
                    <div class="code" id="waiting-room-code">XXXXXXXX</div>
                    <div class="hint">Chia s·∫ª m√£ n√†y ƒë·ªÉ b·∫°n b√® tham gia</div>
                </div>
                <div class="waiting-players">
                    <div class="player-slot filled" id="host-slot">
                        <div class="player-name" id="host-name">Host</div>
                        <div class="player-rating" id="host-rating">1500</div>
                    </div>
                    <div class="player-slot empty" id="guest-slot">
                        <div class="player-name" id="guest-name"><span class="waiting-spinner"></span>ƒêang ch·ªù...</div>
                        <div class="player-rating" id="guest-rating"></div>
                    </div>
                </div>
                <div id="waiting-room-status">
                    <p>ƒêang ch·ªù ƒë·ªëi th·ªß tham gia...</p>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-danger" onclick="leaveRoom()">R·ªùi Ph√≤ng</button>
                    <button type="button" class="btn-primary" id="btn-start-room-game" disabled>B·∫Øt ƒê·∫ßu</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="../src/pages/lobby.js"></script>
</body>

</html>